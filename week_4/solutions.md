### Basic Auth
#### The conditions of a given task: 
`–ê–¥–º–∏–Ω —Å–∞–π—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∏–ª –ø–∞—Ä–æ–ª—å —Ä–∞–≤–Ω—ã–π —Å–≤–æ–µ–º—É –≥–æ–¥—É —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É /admin. –°–º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è?`
#### Solution:
at first we see the **authorization header** with **base64 encoded login:password**
`Authorization: Basic YWRtaW4gOmFkbWlu`

we know that *password kinda like \d{4}* and we can bruteforce it with **Burp Intruder** like 
![Alt text](img/image.png)
![Alt text](img/image-2.png)

you must **turn off URL-encode** cause == in the end of base64 string and *add rules* to **add admin: in the start of the payload** and **encode as base64**
now sort by response code and find the flag like ![Alt text](img/image-3.png)

Answer is: ***5acf749f5ebc87228630d9568ed271aa69ef5c942e327b624ad52c4346fdffa6a90970c4c6d8238c6afed38f7c0546df***

***

### –ü–æ–¥–¥–µ–ª—ã–≤–∞–µ–º User-Agent
#### The conditions of a given task: 
`–í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä Mosaic/0.9`
#### Solution:
you can use Burp/curl/python/browser extension/browser developer tools idk
but i prefer burp
![Alt text](img/image-4.png)
*Answer for it request*
![Alt text](img/image-5.png)

Answer is: ***f2f82b149e4aca9e1d03c001c07d2b381dbb15d872d0d552963a377b606373b20c946b25aff6e943b4967bc03140be42***

***

### –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
#### The conditions of a given task: 
`–û—Ç–≤–µ—Ç –≥–¥–µ-—Ç–æ –≤ –∫–∞–±–∏–Ω–µ—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –ù–æ –∫–∞–∫–æ–π –ø–∞—Ä–æ–ª—å? –í—ã –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MySQL.`
#### Solution:
Login form can be vulnerable to SQLi, let's check
after trying *`password="`* we can see that answer has 500+ answer code
tryna **`username = admin" -- `** with *any password field*
![Alt text](img/image11.png)
and the response is 
![Alt text](img/image-12.png)
Answer is: ***012bd332877198e8af9e4049408047ef60a3a40c532b5d75853e3d6b591be3876e805bd5b7ec4be880afde491fdff658***

***

### –£—è–∑–≤–∏–º–æ—Å—Ç—å IDOR
#### The conditions of a given task: 
`–ù–∞–π–¥–∏—Ç–µ —Ñ–ª–∞–≥ –≤ –∏–º–µ–Ω–∏ –æ–¥–Ω–æ–≥–æ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`
#### Solution:
after simple signup and login we discovered that url for profile page is *[https://f560b642-0c6d-42fb-a69a-5549a9240512.web.lms.itmo.xyz/user/26](https://f560b642-0c6d-42fb-a69a-5549a9240512.web.lms.itmo.xyz/user/26)*
and **we can enumirate users via changing iser_id /26**
again we start intruder sniper attack ![Alt text](img/image-6.png)
*do some filter* to find our flag in responses ![Alt text](img/image-7.png)
and now we see it 
![Alt text](img/image-8.png)

Answer is: ***93c9465b9d690d2120e01f059e780a9aab66e5ce673258b620b568806303c3a69e522c5743beaea17e43486f7c7d809***

***

### –ó–∞–≥—Ä—É–∑–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É
#### The conditions of a given task: 
<code>üìÉ –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
–í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å PNG —Ñ–∞–π–ª —Å —Ç–∏–ø–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞ application/flag, –∫–æ—Ç–æ—Ä—ã–π –±—ã –∏–º–µ–ª mime type, –∫–∞–∫ —É PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤–µ—Ä—Å–∏–∏ 1.2 –ø–æ –∞–¥—Ä–µ—Å—É /upload. –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Å —Ñ–∞–π–ª–æ–º ‚Äì file.
‚ö†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
–≠—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å—Å—ã–ª–∫—É –≤–∏–¥–∞ https://<...>.web.itmo.xyz.–í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Ñ–ª–∞–≥ –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–æ–∫—É, —á—Ç–æ–±—ã –∑–∞–¥–∞–Ω–∏–µ –±—ã–ª–æ –∑–∞—Å—á–∏—Ç–∞–Ω–æ.</code>

#### Solution:
go to [https://LAB-ID.web.lms.itmo.xyz/upload](https://LAB-ID.web.lms.itmo.xyz/upload) and try to upload any PNG file
at first do POST on /upload?file=filename and check that answer is `no file part`
![Alt text](img/image-14.png)
cause **we need to add binary pdf file** with extension png that we can change in 
`Content-Disposition: form-data; name="file"; filename="filename.png"` header
also we *need to add* `Content-Type: application/flag` and in a *start* of out binary pdf file we need to `change %PDF-1.5 to %PDF-1.2`
send the request and get our flag!
![Alt text](img/image-13.png)

Answer is: ***936c232036a517296acff0067749687be75ffc04b8e4e9b839657a6fc19df25ab18caaa9ce308910de4fd07af23b2842***

***

### SSTI
#### The conditions of a given task: 
<code>–í –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—á–µ–Ω—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–∞:
\
*@app.route("/api/content", methods=['GET'])
def content():
    content = request.args.get("content")
    return render_template_string(content)*
\
–í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äì –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ flag.txt</code>

#### Solution:
in task description we can see that **template engine is Jinja2**
but you can also use `{{'7'*7}}` payload and if answer is `7777777` - it is 99% Jinja2 like 
![Alt text](img/image-9.png)
use payload with *builtin function open from \__builtins__* to read `flag.txt` in *current directory*
Payload is: 
**{{ get_flashed_messages.__globals__.__builtins__.open("flag.txt").read() }}** 
![Alt text](img/image-10.png)

Answer is: ***732174d8cb49ddcfb8f38502c8e4fb25a89f4cca5ccca40e19f0054b7161c9b725ef903a9fba57f5a172f1214703b608***

***

### –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ 2
#### The conditions of a given task: 
`–£ –≤–∞—Å –µ—Å—Ç—å —Ñ–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –ù–æ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ –ø–∞—Ä–æ–ª—å. –§–ª–∞–≥ –≤ –ø–∞—Ä–æ–ª–µ –∞–¥–º–∏–Ω–∞.`
#### Solution:
Chad solution:
`sqlmap https://d0f38665-9e6b-4388-82b1-3de0ef27e14e.web.lms.itmo.xyz/search --data " query=–õ–µ–Ω–∏–Ω" --level=3 --risk=3 --dbs --columns --tamper=space2comment` 
in a next run we can use options *`-T users -C username`*
Further we make *`–õ–µ–Ω–∏–Ω`* query and see that valid record is given, further we try union based SQLi with the help of *`Lenin' union all select null,null,...,null`* and find out that we are in **Sqllite** (through the version that can be substituted in one of the nulls).
Then it's a matter of technique - *enumeration* of tables via *sqlite_schema* and pull the desired flag.
Payload is: `–õ–µ–Ω–∏–Ω' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,(SELECT password FROM users WHERE username='admin')-- `

Answer is: ***03808f5dce90e045db48ad6046b8746f2100b4783efe830a239b84573d7024d9d620c9e4d885a051095e2e857d926fdc***

***

### –î—Ä–∞–≥ —Ä–µ–π—Å–∏–Ω–≥
#### The conditions of a given task: 
`–ö—É–ø–∏—Ç–µ —Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π –∞–≤—Ç–æ`
#### Solution:
After signup and login we can see that *we have only 1000 but we need a 20000*
now **we need to buy cars with id 6 and 9**(*also we can use double buy for one car*) and *send it to repeater* cos in repeater we have option **send in parallel**
![Alt text](img/image-15.png)
after we *add both request to one group* we can **send all requests in group parallel** to test *race conditions*.
now we can see that *we have option for sell both 6 and 9 cars, but with balans like we buy only 6*(or 9, it depends on sequense)
kinda like this we can buy more than one car with id n or buy a lot of cars with *only one approved **buy** transaction*.
![Alt text](img/image-16.png)

Answer is: ***77fd138a9c6f6412f2ae1a08888a3cd6496f12749858f6d6bf41c5d0441a1cfc5f094273abddf7c11eb620193d72c005***

***
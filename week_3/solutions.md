### –£–≥–∞–¥–∞–π —Ö–µ—à
#### The condition of a given task:
<code>üìÉ¬†–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
\
–í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ –≤–Ω–µ—à–Ω–µ–º—É –≤–∏–¥—É —Ö–µ—à–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ —Ç–∏–ø.
\
üí°¬†–ü–æ–¥—Å–∫–∞–∑–∫–∞ –∫ —Ä–µ—à–µ–Ω–∏—é
\
–ù–µ –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –æ–Ω–∏ –≤–∞—Å –ª–∏—à—å –∑–∞–º–µ–¥–ª—è—Ç.</code>

#### Solution:
just use `https://suip.biz/ru/?act=hashtag` or `hashid` to detect type of the hash
forgot valid flag but one of the actual is

Answer is:
***719cd9f619da1b4362c29f0eb2227295b5e197bdfd7c749f0ff2c35ff20e66dd022b4f9ff33e31bdfcf18bd687032a1e***

***

### IPTables
#### The condition of a given task:
<code>–í–∞–º –¥–∞–Ω –¥–∞–º–ø –ø—Ä–∞–≤–∏–ª –º–µ–∂—Å–µ—Ç–µ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ Iptables. –ü—Ä–∞–≤–∏–ª–∞ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –≤ —Ö–∞–æ—Ç–∏—á–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∏ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∏ –∞–¥—Ä–µ—Å–∞ –ø–æ–¥—Å–µ—Ç–µ—Ç–µ–π –æ—Ç–∫—É–¥–∞ —à–ª–∏ –∞—Ç–∞–∫–∏. –ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å —É—Å–ø–µ—à–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ò–ª–∏ –Ω–µ—Ç? –ù–∞–π–¥–∏—Ç–µ –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–∑ –ø–æ–¥—Å–µ—Ç–∏ 112.0.0.0/4.</code>

#### Solution:
Let's check what inside your [_iptables-dump.txt_](https://lms.itmo.xyz/uploads/xtmbkf1urtps34rn2mcp3it56i96myc6/iptables-dump.txt)
filter it by regex <code>\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\/\d{1,2}\b</code>

At first sort subnets in ascending order of bit length in the mask and check that *you have full path from /4 to /32*(_single adress_) keep in mind that **every step you're halving your not whitelisted subnet**. 
112.0.0.0/4 means 112.0.0.0-127.255.255.255
112.0.0.0/5 means 112.0.0.0-119.255.255.255
so now the _remaining non-blocked addresses_ is **120.0.0.0-127.255.255.255**
124.0.0.0/6 means 124.0.0.0-127.255.255.255
120.0.0.0/7 means 120.0.0.0-121.255.255.255
so now the _remaining non-blocked addresses_ is **122.0.0.0-123.255.255.255**
step by step it's a verbal exercise

>full solution here below on the rignt side alive adresses ranges
Main subnet is 112-127.0.0.0 16
112.0.0.0/5 120-127  
124.0.0.0/6 120-124  
120.0.0.0/7 122-124  
122.0.0.0/8 123-124  

>first bite is 123

>123.128.0.0/9  123.0-128  
123.64.0.0/10  123.0-64  
123.32.0.0/11  123.0-32  
123.0.0.0/12 123.16-32  
123.24.0.0/13 123.16-24 
123.20.0.0/14 123.16-20 
123.18.0.0/15 123.16-18 
123.17.0.0/16 123.16 

>second bite is 16

>123.16.128.0/17 123.16.0-128
123.16.64.0/18  123.16.0-64
123.16.32.0/19  123.16.0-32
123.16.16.0/20  123.16.0-16
123.16.0.0/21   123.16.8-16
123.16.12.0/22  123.16.8-12
123.16.10.0/23  123.16.8-10
123.16.9.0/24   123.16.8

>third bite is 8

>123.16.8.128/25 123.16.8.0-128
123.16.8.64/26  123.16.8.0-64
123.16.8.32/27  123.16.8.0-32
123.16.8.16/28  123.16.8.0-16
123.16.8.0/29   123.16.8.8-16
123.16.8.12/30  123.16.8.8-12
123.16.8.10/31  123.16.8.8-10
123.16.8.9/32   123.16.8.8

>last bite is 8


Answer is: ***123.16.8.8***

***

### DNS Hidden Record
#### The condition of a given task:
<code>‚ö†Ô∏è –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPN —Å–µ—Ç–∏.
\
–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω DNS —Å–µ—Ä–≤–µ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–º–µ–Ω–µ¬†hiddentext.osint. –û—Ç–≤–µ—Ç–æ–º –∫ –¥–∞–Ω–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å (–≤–∏–¥–∞ 98355ba9fcc21782ec6f16975413bb011fe7effb87bce04f551f60944352aa568d25f8782187c89787a9f27cff88).
\
–ü–æ–¥—Å–∫–∞–∑–∫–∞
\
–ù–∞–ø—Ä–∏–º–µ—Ä, –≤–∞–º –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π¬†IP:¬†10.10.10.10:49666. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ DNS —Å–µ—Ä–≤–µ—Ä —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –∞–¥—Ä–µ—Å–æ–º¬†10.10.10.10¬†–∏ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É¬†49666.</code>

#### Solution:
*turn on* your *vpn* and try to `dig @10.10.10.10 -port <your_port> hiddentext.osint txt` 
Obviously, the *text is stored in a txt record* (usually it is), so let's see what txt records this domain has.
and he has a *txt record with our flag*.

Answer is: ***4f9ccb5104ad6b34a10576732e85e9ba5b1b650abcd1500d4908fce7a84e8806f06c341e3f46d78d38a2265f0f0eb785***

***

### DNS —Ç—É–Ω–Ω–µ–ª—å
#### The condition of a given task:
<code>–í–∞–º –¥–∞–Ω–∞ –∑–∞–ø–∏—Å—å —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (PCAP —Ñ–∞–π–ª). –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ –≤–Ω—É—Ç—Ä–∏ DNS —Ç—É–Ω–Ω–µ–ª—è. –ò–∑–≤–ª–µ–∫–∏—Ç–µ —Ñ–ª–∞–≥.</code>

#### Solution:
At first open [_dnstunnel.pcapng_](https://lms.itmo.xyz/uploads/rb2dgvfty7c7vo1ieftc1jyn5021cdh1/dnstunnel.pcapng) in wireshark and try filter like `dns.qry.name.len > 100 && !mdns` for detect _dns tunnels_
now you can see smth like ![that](img/image.png) and find out that long dns query name seems like plaintext in hex
check this theory ![how copy](img/image-1.png) 
and try (www.rapidtables.com)[https://www.rapidtables.com/convert/number/hex-to-ascii.html]
_show the result_!! ![result is](img/image-2.png)
(bruteforce any of this dns query names to find out flag)

Answer is: ***flag{this_is_a_hidden_message_in_dns_requests}***

***

### DNS subdomains
#### The condition of a given task:
<code>–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω DNS —Å–µ—Ä–≤–µ—Ä.¬†–°–∫–æ–ª—å–∫–æ –ø–æ–¥–¥–æ–º–µ–Ω–æ–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –∑–æ–Ω–µ¬†hosting.osint? 
\
–ü–æ–¥–¥–æ–º–µ–Ω—ã ‚Äì –∫–æ—Ä–æ—Ç–∫–∏–µ (–¥–æ 6 —Å–∏–º–≤–æ–ª–æ–≤) —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–ª–æ–≤–∞ —Å—Ç—Ä–æ—á–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ –±–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤.
\
–ü–æ–¥—Å–∫–∞–∑–∫–∞
\
–ù–∞–ø—Ä–∏–º–µ—Ä, –≤–∞–º –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π¬†IP:¬†10.10.10.10:49666. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ DNS —Å–µ—Ä–≤–µ—Ä —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –∞–¥—Ä–µ—Å–æ–º¬†10.10.10.10¬†–∏ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É¬†49666. 
\
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞ –∫–∞–∫–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç DNS?</code>

#### Solution:
*turn on* your *vpn* and try to `gobuster dns -d hosting.osint -w <path/to/your/wordlist> -r 10.10.10.10:<your_port> -q -o output` 
it's **biggest dogshit in tasks** that i solved...
`./massdns -r <file with 10.10.10.10:<your_port>> -t A -o S -w <outputfile> <wordlist>`
Answer is: ***688***

***

### DNS very special domain
#### The condition of a given task:
<code>‚ö†Ô∏è –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPN —Å–µ—Ç–∏.
\
–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω DNS —Å–µ—Ä–≤–µ—Ä.–ö–∞–∫–æ–π IP –∞–¥—Ä–µ—Å –∏–º–µ–µ—Ç –¥–æ–º–µ–Ω, IP –∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö (–≤ –∑–æ–Ω–µ¬†hosting.osint)?¬†–ò—Å–∫–æ–º—ã–µ –ø–æ–¥–¥–æ–º–µ–Ω—ã ‚Äì –∫–æ—Ä–æ—Ç–∫–∏–µ (–¥–æ 6 —Å–∏–º–≤–æ–ª–æ–≤) —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–ª–æ–≤–∞ —Å—Ç—Ä–æ—á–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ –±–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤.
\
–ü–æ–¥—Å–∫–∞–∑–∫–∞
\
–ù–∞–ø—Ä–∏–º–µ—Ä, –≤–∞–º –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π¬†IP:¬†10.10.10.10:49666. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ DNS —Å–µ—Ä–≤–µ—Ä —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –∞–¥—Ä–µ—Å–æ–º¬†10.10.10.10¬†–∏ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É¬†49666.</code>

#### Solution:
with your domain list you can *bruteforce* answer via *this command*:
`cat <path/to/domains/list> | while read domain; do dig @10.10.10.10 -p <your_port> $domain A +noall +answer | grep -v 1.2.3.4; done`
grep -v **1.2.3.4** cause all except one domains have ip `1.2.3.4`
in output we can see that domain *talk.hosting.osint* has ipv4 *172.168.9.19*  

Answer is: ***172.168.9.19***

***

### –ü—Ä–æ—Å–ª—É—à–∫–∞
#### The condition of a given task:
<code>–í–∞–º –¥–∞–Ω –¥–æ—Å—Ç—É–ø –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –ø–æ SSH (–ª–æ–≥–∏–Ω: user, –ø–∞—Ä–æ–ª—å: user).–ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≤ —Å–µ—Ç–∏ —Å –¥–∞–Ω–Ω–æ–π –º–∞—à–∏–Ω–æ–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –µ—â—ë –æ–¥–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–æ–¥–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –æ–¥–Ω–æ–º—É –∏–∑ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.</code>

#### Solution:
at first do `arp -a` and see that we have only *one* host in out network
this host have ip **172.19.0.2** and name **trafik.task**
we can scan ports with *nc* via `for port in {1..65535} do nc -zv 172.19.0.2 $port done` 
see that *172.19.0.2* has two open ports: **80** and **8080**
with `wget 172.19.0.2:8080` we can see index.html of this web page
***no way dead end road***

**better try use `tcpdump` cause you can detect some packets**
in log we see a requests like <code>11:46:39.405189 IP (tos 0x0, ttl 64, id 16566, offset 0,flags [DF], proto UDP (17), length 144)
884c13fa-449d-43a7-bdbf-fcebab8b7084-checker-sender-1.884c13fa-449d-43a7-bdbf-fcebab8b7084_local.52582 > 255.255.255.255.5005: [bad udp cksum 0xc138 -> 0x3bb5!] UDP, length 116</code>
and **tryna check payloads via opening dump file** that we can create and print via 
`tcpdump -w <filename>; cat <filename>` 
inside of it we see secret flag: `80453fa8dce79cd29ee5a79c321a744059dad0d78fceb7bff68de8f505f339b9aca66ad8beede13b0c99965fb98424c7`
![Alt text](img/image-3.png)

Answer is: ***80453fa8dce79cd29ee5a79c321a744059dad0d78fceb7bff68de8f505f339b9aca66ad8beede13b0c99965fb98424c7***

***

### Raw ICMP
#### #### The condition of a given task:
<code>–ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≤–∞—à —Å–æ—Å–µ–¥ –ø–æ —Å–µ—Ç–∏ –ª—é–±–∏—Ç –æ–±—â–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ ICMP –ø—Ä–æ—Ç–æ–∫–æ–ª–∞. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–º—É ICMP —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º¬†give me flag¬†–∏ –±—É–¥—å—Ç–µ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –æ–Ω –≤ –æ—Ç–≤–µ—Ç –ø—Ä–∏—à–ª–µ—Ç –≤–∞–º ICMP —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ñ–ª–∞–≥–æ–º.¬†–í–Ω–∏–º–∞–Ω–∏–µ, —Ñ–ª–∞–≥ –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π –∏–∑ –ø—Ä–∏–º–µ—Ä–Ω–æ 92 –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤.
\
–ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é¬†ping -p</code>

#### Solution:
`apt install net-tools; arp -a` to discover hosts in out network
at first let's find host that responds to the request
`ping -I <network_interface>-s 12 -p 67697665206D6520666C6167 -b -c 1 255.255.255.255`
with something other than the usual echo reply like a path of flag(cause 16 bytes - limit) 
and we need tcpdump to check the payloads from **13b7c5ac-45a9-4531-bae7-59584e0202bc-internal-1.13b7c5ac-45a9-4531-bae7-59584e0202bc_local:(victim)** that answeres smth like ![this](img/image-5.png)
keep in mind that maximum of bytes in payload is 16, and after first 16 bytes server repeats payload.
the flag has lenght like *92* bytes and we can take the first 16 bytes from every reply responce and contatinate it to get the flag
![be careful](img/image-6.png)
but be **careful with duplicates**

Answer is: ***7e25517eca2db9388b06d325732f2b8c9278250b30aa0dab8e61c66b01e039d3e7ef2ea67be5706f5058fee9e3607a3f***

***

